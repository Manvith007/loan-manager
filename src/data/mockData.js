import { calculateEMI, assessRiskScore } from '../utils/loanEngine.js';

// ===== USERS =====
export const users = [
    {
        id: 'u1',
        name: 'Marcus Chen',
        email: 'marcus@loanpro.com',
        role: 'admin',
        avatar: 'ðŸ‘¨â€ðŸ’¼',
        status: 'active',
        joinDate: '2023-01-15',
    },
    {
        id: 'u2',
        name: 'Sarah Wellington',
        email: 'sarah@capital.com',
        role: 'lender',
        avatar: 'ðŸ‘©â€ðŸ’»',
        status: 'active',
        joinDate: '2023-03-22',
        portfolio: 1250000,
        activeLoans: 12,
        totalEarnings: 87500,
    },
    {
        id: 'u3',
        name: 'James Harper',
        email: 'james@invest.com',
        role: 'lender',
        avatar: 'ðŸ§‘â€ðŸ’¼',
        status: 'active',
        joinDate: '2023-05-10',
        portfolio: 780000,
        activeLoans: 8,
        totalEarnings: 54200,
    },
    {
        id: 'u4',
        name: 'Emily Rivera',
        email: 'emily@mail.com',
        role: 'borrower',
        avatar: 'ðŸ‘©',
        status: 'active',
        joinDate: '2023-06-18',
        creditScore: 742,
        dti: 0.28,
        yearsEmployed: 7,
        missedPayments: 0,
        income: 95000,
    },
    {
        id: 'u5',
        name: 'David Okafor',
        email: 'david@mail.com',
        role: 'borrower',
        avatar: 'ðŸ‘¨',
        status: 'active',
        joinDate: '2023-08-05',
        creditScore: 680,
        dti: 0.38,
        yearsEmployed: 3,
        missedPayments: 1,
        income: 72000,
    },
    {
        id: 'u6',
        name: 'Priya Sharma',
        email: 'priya@mail.com',
        role: 'borrower',
        avatar: 'ðŸ‘©â€ðŸ¦±',
        status: 'active',
        joinDate: '2024-01-12',
        creditScore: 810,
        dti: 0.22,
        yearsEmployed: 12,
        missedPayments: 0,
        income: 130000,
    },
    {
        id: 'u7',
        name: 'Alex Thompson',
        email: 'alex@analytics.com',
        role: 'analyst',
        avatar: 'ðŸ§‘â€ðŸ”¬',
        status: 'active',
        joinDate: '2023-04-01',
    },
    {
        id: 'u8',
        name: 'Robert Kim',
        email: 'robert@mail.com',
        role: 'borrower',
        avatar: 'ðŸ‘¨â€ðŸ¦³',
        status: 'inactive',
        joinDate: '2023-09-20',
        creditScore: 520,
        dti: 0.55,
        yearsEmployed: 1,
        missedPayments: 4,
        income: 45000,
    },
];

// ===== LOANS =====
export const loans = [
    {
        id: 'L001',
        borrowerId: 'u4',
        lenderId: 'u2',
        borrowerName: 'Emily Rivera',
        lenderName: 'Sarah Wellington',
        type: 'Personal',
        principal: 25000,
        annualRate: 8.5,
        tenureMonths: 36,
        emi: calculateEMI(25000, 8.5, 36),
        status: 'active',
        disbursedDate: '2025-06-15',
        nextPaymentDate: '2026-03-15',
        paidMonths: 8,
        totalPaid: 0,
        purpose: 'Home Renovation',
    },
    {
        id: 'L002',
        borrowerId: 'u5',
        lenderId: 'u2',
        borrowerName: 'David Okafor',
        lenderName: 'Sarah Wellington',
        type: 'Auto',
        principal: 35000,
        annualRate: 6.25,
        tenureMonths: 60,
        emi: calculateEMI(35000, 6.25, 60),
        status: 'active',
        disbursedDate: '2025-04-01',
        nextPaymentDate: '2026-03-01',
        paidMonths: 10,
        totalPaid: 0,
        purpose: 'Vehicle Purchase',
    },
    {
        id: 'L003',
        borrowerId: 'u6',
        lenderId: 'u3',
        borrowerName: 'Priya Sharma',
        lenderName: 'James Harper',
        type: 'Mortgage',
        principal: 450000,
        annualRate: 4.75,
        tenureMonths: 360,
        emi: calculateEMI(450000, 4.75, 360),
        status: 'active',
        disbursedDate: '2024-09-01',
        nextPaymentDate: '2026-03-01',
        paidMonths: 17,
        totalPaid: 0,
        purpose: 'Home Purchase',
    },
    {
        id: 'L004',
        borrowerId: 'u4',
        lenderId: 'u3',
        borrowerName: 'Emily Rivera',
        lenderName: 'James Harper',
        type: 'Education',
        principal: 40000,
        annualRate: 5.0,
        tenureMonths: 120,
        emi: calculateEMI(40000, 5.0, 120),
        status: 'active',
        disbursedDate: '2025-01-10',
        nextPaymentDate: '2026-03-10',
        paidMonths: 13,
        totalPaid: 0,
        purpose: 'MBA Program',
    },
    {
        id: 'L005',
        borrowerId: 'u5',
        lenderId: 'u3',
        borrowerName: 'David Okafor',
        lenderName: 'James Harper',
        type: 'Business',
        principal: 75000,
        annualRate: 10.5,
        tenureMonths: 48,
        emi: calculateEMI(75000, 10.5, 48),
        status: 'overdue',
        disbursedDate: '2025-03-20',
        nextPaymentDate: '2026-02-20',
        paidMonths: 9,
        totalPaid: 0,
        purpose: 'Startup Capital',
    },
    {
        id: 'L006',
        borrowerId: 'u8',
        lenderId: 'u2',
        borrowerName: 'Robert Kim',
        lenderName: 'Sarah Wellington',
        type: 'Personal',
        principal: 15000,
        annualRate: 14.0,
        tenureMonths: 24,
        emi: calculateEMI(15000, 14.0, 24),
        status: 'defaulted',
        disbursedDate: '2024-06-01',
        nextPaymentDate: '2025-11-01',
        paidMonths: 5,
        totalPaid: 0,
        purpose: 'Debt Consolidation',
    },
    {
        id: 'L007',
        borrowerId: 'u6',
        lenderId: 'u2',
        borrowerName: 'Priya Sharma',
        lenderName: 'Sarah Wellington',
        type: 'Personal',
        principal: 10000,
        annualRate: 7.0,
        tenureMonths: 12,
        emi: calculateEMI(10000, 7.0, 12),
        status: 'completed',
        disbursedDate: '2024-01-15',
        nextPaymentDate: null,
        paidMonths: 12,
        totalPaid: 0,
        purpose: 'Emergency Fund',
    },
    {
        id: 'L008',
        borrowerId: 'u4',
        lenderId: 'u2',
        borrowerName: 'Emily Rivera',
        lenderName: 'Sarah Wellington',
        type: 'Personal',
        principal: 5000,
        annualRate: 9.0,
        tenureMonths: 12,
        emi: calculateEMI(5000, 9.0, 12),
        status: 'completed',
        disbursedDate: '2024-08-01',
        nextPaymentDate: null,
        paidMonths: 12,
        totalPaid: 0,
        purpose: 'Travel',
    },
    {
        id: 'L009',
        borrowerId: 'u5',
        lenderId: 'u2',
        borrowerName: 'David Okafor',
        lenderName: 'Sarah Wellington',
        type: 'Personal',
        principal: 20000,
        annualRate: 11.0,
        tenureMonths: 36,
        emi: calculateEMI(20000, 11.0, 36),
        status: 'pending',
        disbursedDate: null,
        nextPaymentDate: null,
        paidMonths: 0,
        totalPaid: 0,
        purpose: 'Home Improvement',
    },
    {
        id: 'L010',
        borrowerId: 'u6',
        lenderId: 'u3',
        borrowerName: 'Priya Sharma',
        lenderName: 'James Harper',
        type: 'Auto',
        principal: 28000,
        annualRate: 5.5,
        tenureMonths: 48,
        emi: calculateEMI(28000, 5.5, 48),
        status: 'pending',
        disbursedDate: null,
        nextPaymentDate: null,
        paidMonths: 0,
        totalPaid: 0,
        purpose: 'Vehicle Upgrade',
    },
];

// Fill totalPaid
loans.forEach(l => {
    l.totalPaid = Math.round(l.emi * l.paidMonths * 100) / 100;
});

// ===== TRANSACTIONS =====
export const transactions = [];
const txTypes = ['Payment', 'Disbursement', 'Fee', 'Refund'];

loans.filter(l => l.paidMonths > 0).forEach(loan => {
    // disbursement
    if (loan.disbursedDate) {
        transactions.push({
            id: `T-${loan.id}-D`,
            loanId: loan.id,
            type: 'Disbursement',
            amount: loan.principal,
            date: loan.disbursedDate,
            status: 'completed',
            description: `Loan disbursement to ${loan.borrowerName}`,
        });
    }
    // payments
    for (let i = 1; i <= loan.paidMonths; i++) {
        const d = new Date(loan.disbursedDate);
        d.setMonth(d.getMonth() + i);
        transactions.push({
            id: `T-${loan.id}-P${i}`,
            loanId: loan.id,
            type: 'Payment',
            amount: loan.emi,
            date: d.toISOString().split('T')[0],
            status: 'completed',
            description: `EMI payment #${i} from ${loan.borrowerName}`,
        });
    }
});

// Sort by date desc
transactions.sort((a, b) => new Date(b.date) - new Date(a.date));

// ===== LOAN APPLICATIONS (pending) =====
export const loanApplications = [
    {
        id: 'LA001',
        borrowerId: 'u5',
        borrowerName: 'David Okafor',
        type: 'Personal',
        amount: 20000,
        rate: 11.0,
        tenure: 36,
        purpose: 'Home Improvement',
        status: 'pending',
        appliedDate: '2026-02-18',
        creditScore: 680,
    },
    {
        id: 'LA002',
        borrowerId: 'u6',
        borrowerName: 'Priya Sharma',
        type: 'Auto',
        amount: 28000,
        rate: 5.5,
        tenure: 48,
        purpose: 'Vehicle Upgrade',
        status: 'pending',
        appliedDate: '2026-02-20',
        creditScore: 810,
    },
    {
        id: 'LA003',
        borrowerId: 'u8',
        borrowerName: 'Robert Kim',
        type: 'Personal',
        amount: 8000,
        rate: 16.0,
        tenure: 12,
        purpose: 'Medical Bills',
        status: 'rejected',
        appliedDate: '2026-01-15',
        creditScore: 520,
    },
];

// ===== Monthly portfolio data for charts =====
export const monthlyData = [
    { month: 'Mar 25', disbursed: 110000, repaid: 42000, defaults: 0 },
    { month: 'Apr 25', disbursed: 35000, repaid: 48000, defaults: 0 },
    { month: 'May 25', disbursed: 0, repaid: 51000, defaults: 0 },
    { month: 'Jun 25', disbursed: 25000, repaid: 53000, defaults: 0 },
    { month: 'Jul 25', disbursed: 0, repaid: 55000, defaults: 0 },
    { month: 'Aug 25', disbursed: 5000, repaid: 57000, defaults: 0 },
    { month: 'Sep 25', disbursed: 0, repaid: 59000, defaults: 15000 },
    { month: 'Oct 25', disbursed: 0, repaid: 52000, defaults: 0 },
    { month: 'Nov 25', disbursed: 0, repaid: 50000, defaults: 0 },
    { month: 'Dec 25', disbursed: 0, repaid: 55000, defaults: 0 },
    { month: 'Jan 26', disbursed: 0, repaid: 58000, defaults: 0 },
    { month: 'Feb 26', disbursed: 0, repaid: 54000, defaults: 0 },
];

// ===== Loan type distribution =====
export const loanTypeDistribution = [
    { name: 'Personal', value: 4, fill: '#06d6a0' },
    { name: 'Auto', value: 2, fill: '#118ab2' },
    { name: 'Mortgage', value: 1, fill: '#6366f1' },
    { name: 'Education', value: 1, fill: '#ffd166' },
    { name: 'Business', value: 1, fill: '#ef476f' },
];

// ===== Risk distribution for analyst =====
export const borrowers = users.filter(u => u.role === 'borrower');
export const riskData = borrowers.map(b => ({
    name: b.name,
    riskScore: assessRiskScore(b),
    creditScore: b.creditScore,
    dti: b.dti,
    income: b.income,
    missedPayments: b.missedPayments,
}));

// ===== Activity feed =====
export const activityFeed = [
    { id: 1, text: 'Emily Rivera made EMI payment of $789.12 for L001', time: '2 hours ago', type: 'payment' },
    { id: 2, text: 'David Okafor submitted loan application LA001', time: '5 hours ago', type: 'application' },
    { id: 3, text: 'New user Priya Sharma registered', time: '1 day ago', type: 'user' },
    { id: 4, text: 'Loan L005 marked as overdue', time: '2 days ago', type: 'alert' },
    { id: 5, text: 'Sarah Wellington created loan offer for $35,000', time: '3 days ago', type: 'offer' },
    { id: 6, text: 'Priya Sharma submitted loan application LA002', time: '3 days ago', type: 'application' },
    { id: 7, text: 'Robert Kim loan application LA003 rejected', time: '5 days ago', type: 'alert' },
    { id: 8, text: 'Monthly report generated for January 2026', time: '1 week ago', type: 'report' },
];
